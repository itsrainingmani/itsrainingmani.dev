---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout";
import BlogTable from "@/components/BlogTable";

const pageTitle = "Written Archive";

const unwantedTags = new Set(["ClojureFam", "2020", "Projects", "Blogging"]);
const posts = (
	await getCollection("blog", ({ data }) => {
		return data.publish === true && !data.tags.includes("ClojureFam");
	})
).sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

const tags = [...new Set(posts.flatMap((post) => post.data.tags))]
	.filter((p) => !unwantedTags.has(p))
	.sort();

const clojureposts = (
	await getCollection("blog", ({ data }) => {
		return data.publish === true && data.tags.includes("ClojureFam");
	})
).sort((a, b) => a.data.publishDate.valueOf() - b.data.publishDate.valueOf());
---

<BaseLayout pageTitle={pageTitle}>
	<div class='my-4 flex flex-col md:flex-row'>
		<h1 class='basis-2/3 self-start text-left text-4xl'>{pageTitle}</h1>
		<blockquote class='basis-1/3 border-l border-l-black px-3 py-1.5 text-sm italic text-gray-500'>
			“And by the way, everything in life is writable about if you have the outgoing guts to do it,
			and the imagination to improvise. The worst enemy to creativity is self-doubt.” <br />- Sylvia
			Plath
		</blockquote>
	</div>
	<hr />
	<p class='my-2'>I've written about the following topics:&nbsp;</p><p
		class='my-2 font-mono lowercase'
	>
		{tags.join(", ")}
	</p>
	<BlogTable posts={posts} />
	<br />
	<p class='mb-2 mt-1 font-mono'>
		For my writing about learning Clojure in Public, look no further:
	</p>
	<BlogTable posts={clojureposts} />
</BaseLayout>
